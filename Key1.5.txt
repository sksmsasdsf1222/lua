-- 로블록스 서비스 가져오기
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local TweenService = game:GetService("TweenService")

-- 기본 크기 설정 (10% 줄임)
local originalSize = UDim2.new(0, 450, 0, 250)
local minimizedSize = UDim2.new(0, 225, 0, 45)

-- 메인 프레임 생성
local function createMainFrame()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "HighQualityGui"
    screenGui.Parent = playerGui

    local frame = Instance.new("Frame")
    frame.Size = originalSize
    frame.Position = UDim2.new(0.5, -225, 0.5, -125) -- Y 위치를 수정하여 중앙으로 배치
    frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true
    frame.Parent = screenGui

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 15) -- 부드러운 곡선
    corner.Parent = frame

    return frame, screenGui
end

-- 상단 타이틀바 및 닫기 버튼 생성
local function createTitleBar(frame)
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, 35)
    titleBar.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    titleBar.Parent = frame

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -80, 1, 0) -- 더 넓은 제목 공간
    titleLabel.Position = UDim2.new(0, 10, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "[ KR ] Narlum Hub"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.Font = Enum.Font.SourceSansBold
    titleLabel.TextSize = 20
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = titleBar

    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 35, 1, 0)
    closeButton.Position = UDim2.new(1, -45, 0, 0)
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Font = Enum.Font.SourceSansBold
    closeButton.TextSize = 20
    closeButton.Parent = titleBar

    local cornerButton = Instance.new("UICorner")
    cornerButton.CornerRadius = UDim.new(0, 10)
    cornerButton.Parent = closeButton

    -- 닫기 버튼 클릭 시 GUI 숨기기
    closeButton.MouseButton1Click:Connect(function()
        frame.Parent:Destroy()
    end)
end

-- 키 입력 창 생성
local function createInputSection(frame)
    local inputPrompt = Instance.new("TextBox")
    inputPrompt.Size = UDim2.new(0.85, 0, 0, 50)  -- 세로 축소
    inputPrompt.Position = UDim2.new(0.075, 0, 0.3, 0)
    inputPrompt.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    inputPrompt.TextColor3 = Color3.fromRGB(0, 0, 0)
    inputPrompt.Font = Enum.Font.SourceSans
    inputPrompt.TextSize = 24
    inputPrompt.PlaceholderText = "키를 입력하세요..."
    inputPrompt.TextXAlignment = Enum.TextXAlignment.Center
    inputPrompt.TextYAlignment = Enum.TextYAlignment.Center
    inputPrompt.Parent = frame

    local completeButton = Instance.new("TextButton")
    completeButton.Size = UDim2.new(0.85, 0, 0, 50)
    completeButton.Position = UDim2.new(0.075, 0, 0.6, 0)  -- 입력창과 가까이 배치
    completeButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    completeButton.Text = "완료"
    completeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    completeButton.Font = Enum.Font.SourceSansBold
    completeButton.TextSize = 22
    completeButton.Parent = frame

    local cornerInput = Instance.new("UICorner")
    cornerInput.CornerRadius = UDim.new(0, 12)
    cornerInput.Parent = inputPrompt

    local cornerComplete = Instance.new("UICorner")
    cornerComplete.CornerRadius = UDim.new(0, 12)
    cornerComplete.Parent = completeButton

    -- 완료 버튼 클릭 시 입력 처리
    completeButton.MouseButton1Click:Connect(function()
        print("입력된 키: " .. inputPrompt.Text)
        frame.Parent:Destroy()  -- 완료 후 GUI 제거
    end)
end

-- 섬광탄 효과 생성
local function createFlashEffect(screenGui)
    local flashFrame = Instance.new("Frame")
    flashFrame.Size = UDim2.new(1, 0, 1, 0)  -- 화면 전체를 덮음
    flashFrame.Position = UDim2.new(0, 0, 0, 0)
    flashFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    flashFrame.BackgroundTransparency = 1
    flashFrame.Parent = screenGui

    -- 섬광탄 애니메이션
    local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut)
    local tweenGoal = { BackgroundTransparency = 0 }
    local tween = TweenService:Create(flashFrame, tweenInfo, tweenGoal)

    tween:Play()
    tween.Completed:Connect(function()
        local fadeOutTween = TweenService:Create(flashFrame, tweenInfo, { BackgroundTransparency = 1 })
        fadeOutTween:Play()
        fadeOutTween.Completed:Connect(function()
            flashFrame:Destroy()
        end)
    end)
end

-- GUI 생성 및 섬광탄 효과 호출
local frame, screenGui = createMainFrame()
createTitleBar(frame)
createInputSection(frame)

-- 섬광탄 효과를 2초 후에 적용
wait(2)
createFlashEffect(screenGui)